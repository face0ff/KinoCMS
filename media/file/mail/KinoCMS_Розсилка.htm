<!DOCTYPE html>
<html style="height: auto;" lang="en"><script async="false" type="text/javascript" src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/in-page.js"></script><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>KinoCMS | Розсилка</title>

    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet" href="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <!-- Theme style -->
    <link rel="stylesheet" href="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/dataTables.bootstrap4.min.css">

    <!-- datatables -->
    <link rel="stylesheet" href="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/adminlte.min.css">
    <link rel="stylesheet" href="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/styles.css">
    <link rel="stylesheet" href="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/jquery-ui.css">

    <link rel="stylesheet" href="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/bootstrap.min_002.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <!-- jQuery -->
    <script src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/jquery-3.6.0.js"></script>
    <script src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/jquery-ui.js"></script>
  <!-- AdminLTE App -->
    <script src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/adminlte.min.js"></script>

    <script src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/jquery.min.js"></script>
    <script src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/bootstrap.min.js"></script>
</head>
<body class="sidebar-mini layout-fixed" style="height: auto;">
    <!-- Site wrapper -->
    <div class="wrapper">
      <!-- Navbar -->
      <nav class="main-header navbar navbar-expand navbar-light">
        <!-- Left navbar links -->
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" data-widget="pushmenu" href="#" role="button" style="transform: rotate(90deg)">|||</a>
          </li>
        </ul>

        <!-- Right navbar links -->
        <ul class="navbar-nav ml-auto">
          <!-- Navbar Search -->
            <li class="nav-item">
              <a class="nav-link" href="#" role="button">
                  <img src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/admin-logo.png" style="width: 30px; height: 30px;">
                    Мой кабинет
              </a>
            </li>

            <li class="nav-item">
            <a class="nav-link" href="#" role="button" data-toggle="modal" data-target="#logoutModal">
                <img src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/power-off.jpg" style="width: 30px; height: 30px;">
              <i class="fas fa-search"></i>
            </a>
          </li>
        </ul>
      </nav>
      <!-- /.navbar -->

    <!-- Modal window for logout -->

    <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Logout</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">×</span>
            </button>
          </div>
          <div class="modal-body">
            Вы уверены, что хотите выйти?
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Скасувати</button>
            <a class="btn btn btn-danger" href="http://138.68.64.203/ru/user/logout/">Выйти</a>
          </div>
        </div>
      </div>
    </div>

      <!-- Main Sidebar Container -->
      <aside class="main-sidebar main-sidebar-custom sidebar-dark-primary elevation-4">
        <!-- Brand Logo -->
        <a href="http://138.68.64.203/ru/home/" class="brand-link">
          <img src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/cinema-logo.png" alt="KinoCMS" class="brand-image img-circle elevation-3" style="opacity: .8">
          <span class="brand-text font-weight-light">KinoCMS</span>
        </a>

        <!-- Sidebar -->
        <div class="sidebar" style="overflow-y: auto;">
          <!-- Sidebar Menu -->
          <nav class="mt-2">
            <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
              <!-- Add icons to the links using the .nav-icon class
                   with font-awesome or any other icon font library -->
                <li class="nav-item">
                  <a href="http://138.68.64.203/ru/admin_cms/statistics/" class="nav-link">
                    <i class="nav-icon fas fa-chart-pie"></i>
                    <p>
                      {% trans 'Статистика' %}
                    </p>
                  </a>
                </li>

                <li class="nav-item">
                <a href="http://138.68.64.203/ru/admin_cms/banner/" class="nav-link">
                  <i class="nav-icon fas fa-photo-video"></i>
                  <p>
                    Баннера | Слайдеры
                  </p>
                </a>
              </li>

              <li class="nav-item">
                <a href="http://138.68.64.203/ru/admin_cms/movie/" class="nav-link">
                  <i class="nav-icon fas fa-film"></i>
                  <p>
                    {% trans 'Фильмы' %}
                  </p>
                </a>
              </li>

              <li class="nav-item">
                <a href="http://138.68.64.203/ru/admin_cms/cinema/" class="nav-link">
                  <i class="nav-icon fas fa-landmark"></i>
                  <p>
                    Кинотеатры
                  </p>
                </a>
              </li>

              <li class="nav-item">
                <a href="http://138.68.64.203/ru/admin_cms/news/" class="nav-link">
                  <i class="nav-icon fas fa-newspaper"></i>
                  <p>
                    {% trans 'Новости' %}
                  </p>
                </a>
              </li>

              <li class="nav-item">
                <a href="http://138.68.64.203/ru/admin_cms/events/" class="nav-link">
                  <i class="nav-icon fas fa-calendar-day"></i>
                  <p>
                    Акции
                  </p>
                </a>
              </li>

              <li class="nav-item">
                <a href="http://138.68.64.203/ru/admin_cms/pages/" class="nav-link">
                  <i class="nav-icon fas fa-pager"></i>
                  <p>
                    Страницы
                  </p>
                </a>
              </li>

              <li class="nav-item">
                <a href="http://138.68.64.203/ru/admin_cms/users/" class="nav-link">
                  <i class="nav-icon fas fa-users"></i>
                  <p>
                    Пользователи
                  </p>
                </a>
              </li>

              <li class="nav-item">
                <a href="http://138.68.64.203/ru/admin_cms/mailing/" class="nav-link">
                  <i class="nav-icon fas fa-envelope"></i>
                  <p>
                    Рассылки
                  </p>
                </a>
              </li>

            </ul>
          </nav>
          <!-- /.sidebar-menu -->
        </div>
        <!-- /.sidebar -->
        <!-- /.sidebar-custom -->
      </aside>

      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper" style="min-height: 646.2px;">
        <!-- Content Header (Page header) -->
        <section class="content-header">
          <div class="container-fluid">
            
            

            

          </div>
        </section>

        <!-- Main content -->
        <section class="content">

          <div class="container-fluid">
            

        <h1 class="text-center">Email</h1>
        <form action="/ru/admin_cms/mailing/" method="post" enctype="multipart/form-data" style="border-radius: 25px; border: 2px solid black; padding: 25px;">
            <input type="hidden" name="csrfmiddlewaretoken" value="lvLINmdwQ04D2ol9mPBwVuJnU2xbZDOficxkSLTx42WfloenAhiBxpdZBxGhXiuA">
            <div class="flex-column">
                <div class="form-group row">
                    <div class="col-sm-4 col-md-4 col-lg-4">
                        <label class="col-form-label">Выбрать, кому выслать:</label>
                    </div>
                    <div class="form-check form-check-inline col-sm-2">
                        <label for="id_all_users_0"><input type="radio" name="all_users" value="True" id="id_all_users_0" required="">
 Всім користувачам</label>
                    </div>
                    <div class="form-check form-check-inline col-sm-4">
                        <label for="id_all_users_1"><input type="radio" name="all_users" value="False" id="id_all_users_1" required="">
 Вибраним користувачам</label>
                        <button disabled="disabled" id="choose-users-button" type="button" class="btn btn-primary" data-toggle="modal" data-target="#users-window" style="margin-left: 4%">
                          Выбрать пользователей
                        </button>
                    </div>
                </div>
                <div class="form-group row" style="padding-top: 15px;">
                    <div class="col-6 row">
                        <div class="row col-12" style="margin-bottom: 15px;">
                            <label class="col-sm-6">Выберите файл: </label>
                            <div class="col-sm-6">
                                <span class="btn btn-success btn-file"> {% trans 'Загрузить ' %}
                                    <input type="file" name="file" id="id_file" accept=".txt,.html">
                                </span>
                            </div>
                        </div>
                        <div class="row col-12" style="margin-bottom: 15px;">
                            <label class="col-sm-6">{% trans 'Загрузить ' %} </label>
                            <p id="uploaded-html-file" class="col-sm-6">Файл не выбран</p>
                            <input type="number" id="id_file-for-mailing" name="file-for-mailing" style="display: none;" required="">
                        </div>
                        <div class="row col-12" style="margin-bottom: 15px;">
                            <label class="col-sm-6">Количество избранных пользователей: </label>
                            <p id="amount-chosen-users" class="col-sm-6">0</p>
                        </div>
                    </div>
                    <div class="col-6">
                        <div id="files-collection" style="border: solid 1px black; border-radius: 10px; padding-left: 10px;">
                            <p class="text-center">Файлы</p>
                            
                                <div class="row col-12">
                                    <input class="file-names form-inline" id="id_file-1" name="file-names" type="radio" value="1">
                                    <label class="col-form-label" for="id_file-1" style="margin-left: 2%;">Без_названия_1.html</label>
                                </div>
                            
                        </div>
                    </div>
                </div>
            </div>

<!-- Modal -->
            <div class="modal fade" id="users-window" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="staticBackdropLabel">Выбор пользователей</h5>
                        </div>
                        <div class="modal-body" style="margin-left: 4%;">
                            <div class="row">
                                <div id="table-users_wrapper" class="dataTables_wrapper dt-bootstrap4 no-footer"><div class="row"><div class="col-sm-12 col-md-6"><div class="dataTables_length" id="table-users_length"><label>Show <select name="table-users_length" aria-controls="table-users" class="custom-select custom-select-sm form-control form-control-sm"><option value="1">1</option><option value="5" selected="selected">5</option><option value="10">10</option></select> entries</label></div></div><div class="col-sm-12 col-md-6"><div id="table-users_filter" class="dataTables_filter"><label>Search:<input type="search" class="form-control form-control-sm" placeholder="" aria-controls="table-users"></label></div></div></div><div class="row"><div class="col-sm-12"><table id="table-users" class="display table col-md-12 col-sm-12 dataTable no-footer" role="grid" aria-describedby="table-users_info" style="width: 0px;">
                                    <thead>
                                        <tr role="row"><td class="sorting sorting_asc" tabindex="0" aria-controls="table-users" rowspan="1" colspan="1" style="width: 0px;" aria-sort="ascending" aria-label=": activate to sort column descending"></td><td class="sorting" tabindex="0" aria-controls="table-users" rowspan="1" colspan="1" style="width: 0px;" aria-label="Email: activate to sort column ascending">Email</td><td class="sorting" tabindex="0" aria-controls="table-users" rowspan="1" colspan="1" style="width: 0px;" aria-label="{% trans 'ФИО ' %}: activate to sort column ascending">{% trans 'ФИО ' %}</td><td class="sorting" tabindex="0" aria-controls="table-users" rowspan="1" colspan="1" style="width: 0px;" aria-label="{% trans 'Псевдоним' %}: activate to sort column ascending">{% trans 'Псевдоним' %}</td><td class="sorting" tabindex="0" aria-controls="table-users" rowspan="1" colspan="1" style="width: 0px;" aria-label="{% trans 'Дата рождения' %}: activate to sort column ascending">{% trans 'Дата рождения' %}</td><td class="sorting" tabindex="0" aria-controls="table-users" rowspan="1" colspan="1" style="width: 0px;" aria-label="{% trans 'Город' %}: activate to sort column ascending">{% trans 'Город' %}</td></tr></thead>
                                    
                                        <tbody>
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                <tr style="margin-left: 10px;" class="odd">
                                            <td class="sorting_1"><input id="id_send_to_current_user" class="count-checking" name="send_to_current_user" type="checkbox" value="test1@gmail.com"></td>
                                            <td>test1@gmail.com</td>
                                            <td>Surname eqwooQuo</td>
                                            <td>zEintQEY-from-command</td>
                                            <td>11.01.1994</td>
                                            <td>Lviv</td>
                                        </tr><tr style="margin-left: 10px;" class="even">
                                            <td class="sorting_1"><input id="id_send_to_current_user" class="count-checking" name="send_to_current_user" type="checkbox" value="test2@gmail.com"></td>
                                            <td>test2@gmail.com</td>
                                            <td>Surname aNkfQ18d</td>
                                            <td>QdTSpkkv-from-command</td>
                                            <td>21.02.1991</td>
                                            <td>Chernivsti</td>
                                        </tr><tr style="margin-left: 10px;" class="odd">
                                            <td class="sorting_1"><input id="id_send_to_current_user" class="count-checking" name="send_to_current_user" type="checkbox" value="test3@gmail.com"></td>
                                            <td>test3@gmail.com</td>
                                            <td>Surname bkxeTBdj</td>
                                            <td>KEjF8QBR-from-command</td>
                                            <td>23.04.1979</td>
                                            <td>Odesa</td>
                                        </tr><tr style="margin-left: 10px;" class="even">
                                            <td class="sorting_1"><input id="id_send_to_current_user" class="count-checking" name="send_to_current_user" type="checkbox" value="test4@gmail.com"></td>
                                            <td>test4@gmail.com</td>
                                            <td>Surname 9fJQvnDF</td>
                                            <td>oOt7ggNI-from-command</td>
                                            <td>27.03.1974</td>
                                            <td>Dnipro</td>
                                        </tr><tr style="margin-left: 10px;" class="odd">
                                            <td class="sorting_1"><input id="id_send_to_current_user" class="count-checking" name="send_to_current_user" type="checkbox" value="nikitindima1206@gmail.com"></td>
                                            <td>nikitindima1206@gmail.com</td>
                                            <td>Nikitin Dima</td>
                                            <td>Dima</td>
                                            <td>15.11.2000</td>
                                            <td>City</td>
                                        </tr></tbody></table></div></div><div class="row"><div class="col-sm-12 col-md-5"><div class="dataTables_info" id="table-users_info" role="status" aria-live="polite">Showing 1 to 5 of 7 entries</div></div><div class="col-sm-12 col-md-7"><div class="dataTables_paginate paging_simple_numbers" id="table-users_paginate"><ul class="pagination"><li class="paginate_button page-item previous disabled" id="table-users_previous"><a href="#" aria-controls="table-users" data-dt-idx="0" tabindex="0" class="page-link">Previous</a></li><li class="paginate_button page-item active"><a href="#" aria-controls="table-users" data-dt-idx="1" tabindex="0" class="page-link">1</a></li><li class="paginate_button page-item "><a href="#" aria-controls="table-users" data-dt-idx="2" tabindex="0" class="page-link">2</a></li><li class="paginate_button page-item next" id="table-users_next"><a href="#" aria-controls="table-users" data-dt-idx="3" tabindex="0" class="page-link">Next</a></li></ul></div></div></div></div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal" data-bs-dismiss="modal">Закрыть</button>
                            <button type="button" onclick="countChecked()" data-dismiss="modal" data-bs-dismiss="modal" class="btn btn-primary">{% trans 'Выбрать' %}</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-8"></div>
                <div class="col-4"><button type="submit" class="row btn btn-success float-right" style="margin: 0 0 4% 0">{% trans 'Начать рассылку ' %}</button></div>
            </div>
        </form>


          </div>
        </section>
      </div>
      <!-- /.content-wrapper -->
    <div id="sidebar-overlay"></div></div>
    <!-- ./wrapper -->
    <script src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/script.js"></script>
    <script src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/jquery.dataTables.min.js"></script>
    
    <script src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/jquery.dataTables.min_002.js"></script>
    <script src="KinoCMS%20%D0%A0%D0%BE%D0%B7%D1%81%D0%B8%D0%BB%D0%BA%D0%B0_files/dataTables.bootstrap4.min.js"></script>
    <script>
        $(document).ready( function () {
            $('#table-users').DataTable({
                pageLength: 5,
                lengthMenu: [1, 5, 10],
            });
        } );

        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        $("#id_file").change(function(){
            let formData = new FormData();
            formData.append('file', $('#id_file')[0].files[0]);
            formData.append('csrfmiddlewaretoken', 'lvLINmdwQ04D2ol9mPBwVuJnU2xbZDOficxkSLTx42WfloenAhiBxpdZBxGhXiuA');
            $.ajax({
                url: "/ru/admin_cms/files/",
                type: 'post',
                data: formData,
                cache: false,
                processData: false,
                contentType: false,
                success: function(data){

                    let file_collection = $('#files-collection')
                    file_collection.empty()
                    file_collection.append(`<p class="text-center"> Файлы</p>`)
                    for (let i = 0; i < data['files'].length; i++) {
                        let stringToAppend = `<div class="row col-12">
                                <input class="file-names form-inline" id="id_file-${data['files'][i][0]}" name="file-names" type="radio" value="${data['files'][i][0]}">
                                <label class="col-form-label" for="id_file-${data['files'][i][0]}" style="margin-left: 2%;">${data['files'][i][1]}</label>
                            </div>`
                        file_collection.append(stringToAppend);
                    }
                    let arrayLength = data['files'].length-1;

                    $(`input#id_file-${data['files'][0][0]}`).prop('checked', true);
                    $('#uploaded-html-file').text(data['files'][0][1]);
                    $('#id_file-for-mailing').attr('value', (data['files'][0][0]));
                }
            });
        });

        $(document).on('click', '.file-names', function () {
            let id_input = $(this).attr('id')
            let labelValue = $(`label[for='${id_input}']`).text();
            $('#uploaded-html-file').text(labelValue);
            $('#id_file-for-mailing').attr('value', ($(this).val()));
        })

        $(document).ready(function() {
            $('input:radio[name=all_users]').click(function() {
                var checkval = $('input:radio[name=all_users]:checked').val();
                $('#choose-users-button').prop('disabled', !(checkval == 'False' || checkval == undefined));
                if (checkval == 'True') {
                    $('#amount-chosen-users').text('7');
                }
                if (checkval == 'False') {
                    $('#amount-chosen-users').text('0');
                }
            });
        });

        function countChecked() {
            $('#amount-chosen-users').text($(".count-checking:checked").length);
        }
    </script>



</body></html>